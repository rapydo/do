language: python
sudo: required
dist: xenial
services:
- docker
script:
- pip3 install --upgrade setuptools
- pip3 install --upgrade -r dev-requirements.txt
- pip3 install --upgrade --no-cache-dir --editable .
- rapydo --version
- rapydo --help
- git clone https://github.com/rapydo/tests.git rapydo_tests
- BRANCH=`[  -z "$TRAVIS_PULL_REQUEST_BRANCH" ] && echo "$TRAVIS_BRANCH" || echo "$TRAVIS_PULL_REQUEST_BRANCH"`
- echo "BRANCH = ${BRANCH}"
- cd rapydo_tests
- git checkout $BRANCH
- mkdir -p data
- export LOGURU_LEVEL=DEBUG
- TESTING=1 py.test -s -x --cov=controller ../tests
after_success:
- coveralls
- pwd
jobs:
  include:
  - stage: test
    python: 3.5
  - python: 3.6.5
  - python: 3.7.1

notifications:
  email: false
  slack:
    rooms:
      secure: VBkLxMwcNSpYQeg5LUyLz5O28Eq/KztevWZP04vdT5qFyKXo7xbygGaxgHcE8mG3TCmdsbyW7B3Pjc+63G2FlCKK+4icHrsEiP9BFRychD2CrpxhjgbEOArkMRbuN1FetDucUhq5ac8oMJpVXvHvN4jLZrk5GrH+SYL2co6yvWILujUpT5XoKF0/Hh5m8Xa+eYs0vH45on6vlwOz0Opv7n3itgrEVCklQzghVYpNuUiRn8RE98afeV3ePvs3TOmws3ZtjWMeqbB43au4iPe926sxj6OAoKXFVpRqozyQRCI1FPlMt+2c4jbrwl0ZqWqI/6TbSVU9lplPopkwYSK8RcwMelTP4XX4wxZK410+7rmgkNoCcB/lFCFd0ytmFcgS1fPfCM8zS9FCJeBfqvjUynCxzss2MuFu95pmCDtPrwapefUViJlHih6roWY+EPRJD2NftNeWO/xeVrOSoNqhaqL2tFhBiIbmJuMlhL+CKle1UP8IeBEa215AMyq+VGYigOvTTscn+zkDj0857RC/oyf8sPTtRk1qnic1Ajd4Uqs0qSUlyIAdlSu8YNN5hyUQIJA8hogZZlvXV90gj5w8XBH1VbaecBLcwdyJZQ4hQ+7vhE/UxiQWmqlYlgdGbAIRniRFZm12i6MrDEK8EMVH7SImDc8ZTGuGbNY/Tcgfw8Q=
    on_success: change # default: always
    on_failure: always # default: always
